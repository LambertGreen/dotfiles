#!/usr/bin/env just
# -*- mode: just -*-

# Justfile for **macOS** systemâ€‘level maintenance tasks
# This assumes Homebrew is installed and that the `mas` utility is available
# for MacÂ AppÂ Store automation. Import the common helpers shared with the
# Linux Justfile so we can reâ€‘use generic targets (e.g. brewâ€‘*).

import '~/.justfile_common'
import '~/.justfile_posix'

# * Default
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# @category General

default:
    @just --list

# * MacÂ AppÂ Store
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# @category Macâ€‘Appâ€‘Store

# ğŸ” Preview which MacÂ AppÂ Store apps are outdated
mas-check:
    @echo "ğŸ” Checking for MacÂ AppÂ Store updatesâ€¦"
    mas outdated

# ğŸ“¦ Upgrade all MacÂ AppÂ Store apps
mas-upgrade:
    @echo "ğŸ“¦ Upgrading MacÂ AppÂ Store appsâ€¦"
    mas upgrade

# * macOS System Updates
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# @category macOS

# ğŸ§­ Check available macOS software updates
os-check:
    @echo "ğŸ§­ Checking for macOS updatesâ€¦"
    softwareupdate -l

# ğŸ› ï¸ Apply all available macOS software updates
os-upgrade:
    @echo "ğŸ› ï¸ Installing all available macOS updates (requires sudo)â€¦"
    sudo softwareupdate -ia

# ğŸ§° Verify Xcode Commandâ€‘LineÂ Tools presence
xcode-check:
    @echo "ğŸ§° Checking for Xcode Command Line Toolsâ€¦"
    @sh -c 'if xcode-select -p >/dev/null 2>&1; then \
      echo "âœ… Xcode CLT installed at: $(xcode-select -p)"; \
    else \
      echo "âŒ Xcode CLT not installed. Run: xcode-select --install"; \
    fi'

# * System (highâ€‘level convenience targets)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# @category System

# ğŸ” Preview everything that could be updated (apps, brew, OS, toolchains)
system-check: brew-check mas-check os-check xcode-check

# ğŸ› ï¸ **Weekly** fast update (every Monday, for example)
system-upgrade: brew-upgrade mas-upgrade completions-upgrade

# ğŸ§¹ Clean caches (Homebrew) â€” separated so we can compose
system-clean: brew-clean

# ğŸ§¹ğŸ› ï¸ **Monthly** deep maintenance built from smaller pieces
system-maintain: system-upgrade system-clean zinit-upgrade emacs-upgrade os-upgrade xcode-check
