#!/usr/bin/env just
# -*- mode: just -*-

# Justfile for system-level maintenance tasks
import '~/.justfile_common'
import '~/.justfile_posix'

# * Default
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
default:
    @just --list

# * Mac App Store
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# @category Mac-App-Store

# ğŸ” Preview which Mac App Store apps are outdated
mas-check:
    @echo "ğŸ” Checking for Mac App Store updates..."
    mas outdated

# ğŸ“¦ Upgrade all Mac App Store apps
mas-upgrade:
    @echo "ğŸ“¦ Upgrading Mac App Store apps..."
    mas upgrade

# * macOS System Updates
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# @category Mac

# ğŸ§­ Check available macOS software updates
os-check:
    @echo "ğŸ§­ Checking for macOS updates..."
    softwareupdate -l

# ğŸ› ï¸ Apply all available macOS software updates
os-update:
    @echo "ğŸ› ï¸ Installing all available macOS updates (requires sudo)..."
    sudo softwareupdate -ia

# ğŸ§° Check Xcode Command Line Tools
xcode-check:
    @echo "ğŸ§° Checking for Xcode Command Line Tools..."
    @sh -c 'if xcode-select -p > /dev/null 2>&1; then \
      echo "âœ… Xcode CLT is installed at: $(xcode-select -p)"; \
    else \
      echo "âŒ Xcode CLT not installed. Run: xcode-select --install"; \
    fi'

# * System
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# @category System

# ğŸ” Preview system updates without applying them
system-check: brew-check mas-check os-check xcode-check

# ğŸ› ï¸ Fast weekly system update (for Mondays)
system-update: brew-upgrade mas-upgrade completions-update

# ğŸ§¹ Monthly system maintenance (includes cleanup, doctor, and app store)
system-maintain: brew-maintain mas-upgrade zinit-update emacs-update os-update xcode-check
