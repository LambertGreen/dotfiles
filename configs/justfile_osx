#!/usr/bin/env just
# -*- mode: just -*-

# macOS dotfiles stowing by level
# Levels: basic (shell), typical (terminal apps), max (GUI apps)

import 'justfile_common'

# =============================================================================
# MACOS-SPECIFIC PACKAGE LISTS
# =============================================================================

# Basic macOS packages
osx_basic_packages := "package_management_osx package_management_posix git_osx git_work shell_osx gnupg_osx"

# Typical macOS packages (terminal apps)
osx_typical_packages := "alacritty_osx cursor_osx"

# Max macOS packages (GUI apps)
osx_max_packages := "alfred-settings hammerspoon karabiner osx raycast_osx skhd vscode_osx Xresources_osx yabai"

_default:
    @just -f justfile_osx --list

# =============================================================================
# BASIC LEVEL - Shell environment essentials
# =============================================================================

# üî∞ Stow basic macOS configs (shell environment essentials)
stow-basic:
    @echo "üîó Stowing basic macOS configs (shell environment)..."
    just -f justfile_common _remove-conflicting-shell-configs
    just -f justfile_common _stow-basic-common
    stow {{osx_basic_packages}}

# =============================================================================
# TYPICAL LEVEL - Basic + terminal applications
# =============================================================================

# üî∂ Stow typical macOS configs (basic + terminal applications)
stow-typical: stow-basic
    @echo "üîó Stowing typical macOS configs (+ terminal apps)..."
    just -f justfile_common _stow-typical-common
    stow {{osx_typical_packages}}

# =============================================================================
# MAX LEVEL - Typical + GUI applications
# =============================================================================

# üî∏ Stow max macOS configs (typical + GUI applications)
stow-max: stow-typical
    @echo "üîó Stowing max macOS configs (+ GUI apps)..."
    just -f justfile_common _stow-max-common
    stow {{osx_max_packages}}

# =============================================================================
# MANAGEMENT COMMANDS
# =============================================================================

# üîç Dry run basic stowing (show what would be done)
stow-basic-dry:
    @echo "üîç Dry run: basic macOS configs..."
    @echo "üßπ Would remove conflicting shell configs: ~/.bashrc ~/.bash_profile ~/.zshrc ~/.zprofile ~/.profile"
    stow -n {{basic_packages}} {{osx_basic_packages}}

# üîç Dry run typical stowing (show what would be done)
stow-typical-dry:
    @echo "üîç Dry run: typical macOS configs..."
    @echo "üßπ Would remove conflicting shell configs: ~/.bashrc ~/.bash_profile ~/.zshrc ~/.zprofile ~/.profile"
    stow -n {{basic_packages}} {{typical_packages}} {{osx_basic_packages}} {{osx_typical_packages}}
    @echo "üßπ Would stow emacs with --ignore='dot-emacs\.doom'"

# üîç Dry run max stowing (show what would be done)
stow-max-dry:
    @echo "üîç Dry run: max macOS configs..."
    @echo "üßπ Would remove conflicting shell configs: ~/.bashrc ~/.bash_profile ~/.zshrc ~/.zprofile ~/.profile"
    stow -n {{basic_packages}} {{typical_packages}} {{max_packages}} {{osx_basic_packages}} {{osx_typical_packages}} {{osx_max_packages}}
    @echo "üßπ Would stow emacs with --ignore='dot-emacs\.doom'"

# üîÑ Force restow basic configs (unstow then stow)
stow-basic-force:
    @echo "üîÑ Force restowing basic macOS configs..."
    just -f justfile_common _remove-conflicting-shell-configs
    stow -R {{basic_packages}} {{osx_basic_packages}}

# üîÑ Force restow typical configs (unstow then stow)
stow-typical-force:
    @echo "üîÑ Force restowing typical macOS configs..."
    just -f justfile_common _remove-conflicting-shell-configs
    stow -R {{basic_packages}} {{typical_packages}} {{osx_basic_packages}} {{osx_typical_packages}}
    stow -R --ignore='dot-emacs\.doom' emacs

# üîÑ Force restow max configs (unstow then stow)
stow-max-force:
    @echo "üîÑ Force restowing max macOS configs..."
    just -f justfile_common _remove-conflicting-shell-configs
    stow -R {{basic_packages}} {{typical_packages}} {{max_packages}} {{osx_basic_packages}} {{osx_typical_packages}} {{osx_max_packages}}
    stow -R --ignore='dot-emacs\.doom' emacs

# =============================================================================
# MANAGEMENT COMMANDS
# =============================================================================

# üì¶ Show what packages are included at each level
list-packages:
    @echo "üì¶ macOS Package Organization:"
    @echo ""
    just -f justfile_common _list-common-packages
    @echo ""
    @echo "üè† MACOS-SPECIFIC ADDITIONS:"
    @echo "  Basic: {{osx_basic_packages}}"
    @echo "  Typical: {{osx_typical_packages}}"
    @echo "  Max: {{osx_max_packages}}"
